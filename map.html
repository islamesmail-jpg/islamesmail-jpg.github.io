<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>العين السخنة — عقارات | اسلام اسماعيل</title>

  <!-- Font (Arabic) & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

  <style>
    :root{
      --accent:#0b6fb2;
      --accent-dark:#075985;
      --muted:#6b7280;
      --card-bg: #fff;
      --bg:#f6f9fb;
      --glass: rgba(255,255,255,0.6);
      --shadow: 0 6px 18px rgba(10, 20, 30, 0.08);
      --radius: 14px;
    }
    *{box-sizing:border-box;font-family:'Cairo',sans-serif}
    html,body{height:100%;margin:0;background:var(--bg);color:#0f1724}
    a{color:inherit;text-decoration:none}
    header{
      background: linear-gradient(90deg, rgba(11,111,178,0.95), rgba(7,89,133,0.95)), url('https://e.top4top.io/p_36047u0b91.png') center/cover no-repeat;
      padding:28px 20px;
      border-bottom-left-radius:24px;
      border-bottom-right-radius:24px;
      color:white;
      box-shadow:var(--shadow);
    }
    .container{max-width:1200px;margin:0 auto;padding:18px}
    .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .brand{display:flex;gap:12px;align-items:center}
    .brand h1{font-size:20px;margin:0;font-weight:700}
    .brand p{margin:0;font-size:13px;opacity:0.95}
    .searchbar{display:flex;gap:8px;align-items:center;background:rgba(255,255,255,0.12);padding:8px;border-radius:12px}
    .searchbar input{border:0;background:transparent;color:white;outline:none;padding:8px;width:320px}
    .searchbar button{background:transparent;border:1px solid rgba(255,255,255,0.18);padding:8px 12px;border-radius:10px;color:white;cursor:pointer}

    main{margin-top:18px;padding-bottom:60px}
    .grid{display:grid;grid-template-columns: 1fr 360px;gap:18px;align-items:start}
    /* left column */
    .card{background:var(--card-bg);padding:14px;border-radius:12px;box-shadow:var(--shadow)}
    .tabs{display:flex;gap:8px;margin-bottom:12px}
    .tabs button{padding:8px 12px;border-radius:10px;border:0;background:transparent;cursor:pointer}
    .tabs button.active{background:var(--accent);color:white}
    .projects-list{display:grid;gap:12px}
    .project-item{display:flex;gap:12px;align-items:center;padding:12px;border-radius:12px;border:1px solid #eef3f7}
    .project-thumb{width:120px;height:80px;border-radius:10px;background:#eee;flex-shrink:0;overflow:hidden}
    .project-thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .project-info h3{margin:0;font-size:16px}
    .project-info p{margin:6px 0 0;color:var(--muted);font-size:13px}
    .badge{display:inline-block;padding:6px 8px;border-radius:8px;font-size:12px;background:#eef7ff;color:var(--accent)}
    .meta{display:flex;gap:8px;margin-top:8px;align-items:center;font-size:13px;color:var(--muted)}

    /* right column */
    .sticky{position:sticky;top:20px}
    .region-desc{line-height:1.6;color:#0b1b2b}
    .map{width:100%;height:200px;border-radius:10px;overflow:hidden;margin-top:10px}
    .form{display:flex;flex-direction:column;gap:10px}
    .form input,.form select,.form textarea{padding:10px;border-radius:8px;border:1px solid #e6eef6;outline:none}
    .btn{background:var(--accent);color:white;border:none;padding:10px;border-radius:10px;cursor:pointer}

    /* best units */
    .units-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .unit-card{padding:10px;border-radius:10px;border:1px solid #eef3f7;background:linear-gradient(180deg,#fff,#fbfeff)}
    .unit-card h4{margin:0;font-size:14px}
    .unit-meta{font-size:13px;color:var(--muted);margin-top:6px}

    footer{margin-top:24px;text-align:center;color:var(--muted);font-size:13px;padding:18px 0}

    /* responsive */
    @media (max-width:980px){
      .grid{grid-template-columns:1fr}
      .searchbar input{width:160px}
      .units-grid{grid-template-columns:1fr}
      .project-thumb{width:100px;height:70px}
    }
  </style>
</head>
<body>

  <header>
    <div class="container topbar">
      <div class="brand">
        <div style="width:56px;height:56px;border-radius:10px;background:rgba(255,255,255,0.12);display:flex;align-items:center;justify-content:center;font-weight:700">
          <i class="fas fa-city" style="font-size:22px"></i>
        </div>
        <div>
          <h1>العين السخنة — عقارات</h1>
          <p>قائمة المشاريع والوحدات الأفضل في العين السخنة — islamproperty.com</p>
        </div>
      </div>

      <div class="searchbar" role="search" aria-label="بحث مشاريع">
        <input id="searchInput" placeholder="ابحث عن مشروع أو وحدة..." />
        <button id="searchBtn"><i class="fas fa-search"></i></button>
        <button class="btn" id="addSampleBtn" title="أضف مشروع تجريبي">أضف مشروع</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="grid">
      <!-- Left: Projects & Best Units list -->
      <section>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h2 style="margin:0">مشاريع العين السخنة</h2>
            <div class="tabs" role="tablist" aria-label="تصفية المشاريع">
              <button class="active" data-filter="all">الكل</button>
              <button data-filter="developer">المطور</button>
              <button data-filter="resale">إعادة البيع</button>
            </div>
          </div>

          <div style="margin-top:10px" id="projectsContainer" class="projects-list">
            <!-- populated by JS -->
          </div>

          <div style="margin-top:12px;display:flex;justify-content:center">
            <button id="loadMore" class="btn" style="background:var(--accent-dark)">تحميل المزيد</button>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <h3 style="margin:0 0 8px 0">نتائج البحث</h3>
          <div id="searchResults" class="projects-list"></div>
        </div>

      </section>

      <!-- Right: Sidebar -->
      <aside>
        <div class="sticky">
          <div class="card">
            <h3 style="margin-top:0">لماذا العين السخنة؟</h3>
            <p class="region-desc">
              العين السخنة من أهم مناطق البحر الأحمر الاستثمارية والسياحية في مصر — قريبة من القاهرة، مطوّرة بالبنية التحتية، وتناسب شراء شاليهات ووحدات استثمارية وريادة أعمال الضيافة. الصفحة تجمع مشاريع متاحة ووحدات مميزة لتسهيل البحث والاتصال بالمطور أو صاحب الوحدة.
            </p>

            <div class="map" id="map">
              <!-- iframe map -->
              <iframe
                src="https://www.google.com/maps?q=ain+sokhna+egypt&output=embed"
                style="border:0;width:100%;height:100%" allowfullscreen loading="lazy"></iframe>
            </div>
          </div>

          <div class="card" style="margin-top:12px">
            <h3 style="margin:0 0 8px 0">أفضل الوحدات الآن</h3>
            <div id="unitsContainer" class="units-grid">
              <!-- populated by JS -->
            </div>
            <div style="margin-top:10px">
              <a href="#units" style="font-size:13px;color:var(--accent)">عرض كل الوحدات</a>
            </div>
          </div>

          <div class="card" style="margin-top:12px">
            <h3 style="margin:0 0 8px 0">عرض مشروع جديد</h3>
            <form id="projectForm" class="form" onsubmit="return false">
              <input id="proj_name" placeholder="اسم المشروع" required />
              <input id="proj_dev" placeholder="المطور" />
              <input id="proj_area" placeholder="المنطقة (مثلاً: العين السخنة)" />
              <textarea id="proj_desc" placeholder="وصف مختصر للمشروع (سطرين)"></textarea>
              <input id="proj_thumb" placeholder="رابط صورة (اختياري)" />
              <button id="submitProject" class="btn">أرسل المشروع</button>
            </form>
          </div>

          <div class="card" style="margin-top:12px">
            <h3 style="margin:0 0 8px 0">اعرض وحدتك</h3>
            <form id="unitForm" class="form" onsubmit="return false">
              <input id="unit_title" placeholder="عنوان الوحدة (مثال: شاليه 2 غرف)" required />
              <input id="unit_project" placeholder="تابع لأي مشروع" />
              <input id="unit_price" placeholder="السعر (EGP)" />
              <select id="unit_type">
                <option value="sale">للبيع</option>
                <option value="rent">للإيجار</option>
              </select>
              <textarea id="unit_notes" placeholder="ملاحظات عن الوحدة"></textarea>
              <button id="submitUnit" class="btn">أرسل الوحدة</button>
            </form>
          </div>

        </div>
      </aside>
    </div>

    <footer>
      تم إنشاء الصفحة تلقائيًا — islamproperty.com — لوصل API استخدم: <code>/api/projects</code> و <code>/api/units</code>
    </footer>
  </main>

  <script>
    // ===== بيانات تجريبية أولية (fallback) =====
    const SAMPLE_PROJECTS = [
      {
        id: 'p1',
        name: 'قرية زيد ريزورت',
        developer: 'مطور ألف',
        type: 'developer', // developer | resale
        area: 'العين السخنة',
        desc: 'مشروع متكامل شاليهات ومرافق سياحية وقريب من البحر.',
        thumb: 'https://via.placeholder.com/400x300?text=Zaed+Resort'
      },
      {
        id: 'p2',
        name: 'ميفيدا ريزيدنس',
        developer: 'شركة البحر',
        type: 'developer',
        area: 'العين السخنة',
        desc: 'مجمع سكني راقٍ مع خدمات فندقية وإطلالات بحرية.',
        thumb: 'https://via.placeholder.com/400x300?text=Mafida+Residence'
      },
      {
        id: 'p3',
        name: 'شاليه للبيع - ملاك',
        developer: 'إعادة البيع',
        type: 'resale',
        area: 'العين السخنة',
        desc: 'شاليه 2 غرف جاهز للسكن، قريب من المول.',
        thumb: 'https://via.placeholder.com/400x300?text=Resale+Chalet'
      }
    ];

    const SAMPLE_UNITS = [
      { id:'u1', title:'شاليه 2 غرف في زيد', project:'قرية زيد ريزورت', price: '2,400,000', type:'sale', featured:true, notes:'اطلالة بحرية' },
      { id:'u2', title:'شقة استوديو', project:'ميفيدا ريزيدنس', price: '700,000', type:'sale', featured:false, notes:'إطلالة داخلية' },
      { id:'u3', title:'شاليه دوبلكس', project:'ميفيدا ريزيدنس', price: '3,100,000', type:'sale', featured:true, notes:'جاهز للاستلام' }
    ];

    // ===== تغيير هنا لو عندك API حقيقي =====
    const API_PROJECTS = '/api/projects'; // GET returns array of projects
    const API_UNITS    = '/api/units';    // GET returns array of units
    const API_SUBMIT_PROJECT = '/submit-project'; // POST to create project (optional)
    const API_SUBMIT_UNIT    = '/submit-unit';    // POST to create unit (optional)

    // ===== عناصر DOM =====
    const projectsContainer = document.getElementById('projectsContainer');
    const unitsContainer = document.getElementById('unitsContainer');
    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    const searchResults = document.getElementById('searchResults');
    const tabs = document.querySelectorAll('.tabs button');

    // ===== بيانات في الذاكرة =====
    let projects = [];
    let units = [];
    let currentFilter = 'all';
    let itemsToShow = 6;

    // ===== تحميل البيانات: يحاول الـ API أولا ثم fallback =====
    async function fetchData(){
      // try fetch projects
      try {
        const [pjRes, unRes] = await Promise.all([
          fetch(API_PROJECTS).then(r => r.ok ? r.json() : Promise.reject('no projects api')),
          fetch(API_UNITS).then(r => r.ok ? r.json() : Promise.reject('no units api'))
        ]);
        projects = Array.isArray(pjRes) ? pjRes : SAMPLE_PROJECTS;
        units = Array.isArray(unRes) ? unRes : SAMPLE_UNITS;
      } catch (err) {
        // إذا لم يوجد API — استعمل العينات أو localStorage
        const storedP = localStorage.getItem('islam_projects');
        const storedU = localStorage.getItem('islam_units');
        projects = storedP ? JSON.parse(storedP) : SAMPLE_PROJECTS;
        units = storedU ? JSON.parse(storedU) : SAMPLE_UNITS;
      }
      renderProjects();
      renderUnits();
    }

    // ===== Render projects list =====
    function renderProjects(){
      projectsContainer.innerHTML = '';
      const filtered = projects.filter(p => {
        if (currentFilter === 'all') return true;
        if (currentFilter === 'developer') return p.type === 'developer';
        if (currentFilter === 'resale') return p.type === 'resale';
        return true;
      }).slice(0, itemsToShow);

      if (filtered.length === 0) {
        projectsContainer.innerHTML = '<p style="color:var(--muted)">لم تُسجّل مشاريع بعد.</p>';
        return;
      }

      filtered.forEach(p => {
        const div = document.createElement('div');
        div.className = 'project-item';
        div.innerHTML = `
          <div class="project-thumb"><img src="${p.thumb || 'https://via.placeholder.com/400x300?text=No+Image'}" alt="${escapeHtml(p.name)}"></div>
          <div class="project-info" style="flex:1">
            <h3>${escapeHtml(p.name)} <span class="badge">${p.area || ''}</span></h3>
            <p>${escapeHtml(p.desc || '')}</p>
            <div class="meta">
              <div><i class="fas fa-building"></i> ${escapeHtml(p.developer || '')}</div>
              <div style="margin-left:auto"><button class="btn" onclick='openProject("${p.id}")'>عرض المشروع</button></div>
            </div>
          </div>
        `;
        projectsContainer.appendChild(div);
      });
    }

    // ===== Render units (best units pick featured first) =====
    function renderUnits(){
      unitsContainer.innerHTML = '';
      const featured = units.filter(u => u.featured).slice(0,4);
      const rest = units.filter(u => !u.featured).slice(0,4);
      const combined = featured.concat(rest).slice(0,4);

      if (combined.length === 0) {
        unitsContainer.innerHTML = '<p style="color:var(--muted)">لا يوجد وحدات مميزة الآن.</p>';
        return;
      }

      combined.forEach(u => {
        const card = document.createElement('div');
        card.className = 'unit-card';
        card.innerHTML = `
          <h4>${escapeHtml(u.title)}</h4>
          <div class="unit-meta">${escapeHtml(u.project || '')} — ${u.price ? escapeHtml(u.price)+' EGP' : ''}</div>
          <div style="margin-top:8px;font-size:13px;color:var(--muted)">${escapeHtml(u.notes || '')}</div>
          <div style="margin-top:8px"><button class="btn" onclick='contactForUnit("${escapeJs(u.id)}")'>اطلب تفاصيل</button></div>
        `;
        unitsContainer.appendChild(card);
      });
    }

    // ===== Search =====
    function performSearch(q){
      const ql = q.trim().toLowerCase();
      if (!ql) { searchResults.innerHTML = '<p style="color:var(--muted)">اكتب اسم مشروع أو كلمة للبحث.</p>'; return; }
      const projMatches = projects.filter(p => 
        (p.name||'').toLowerCase().includes(ql) ||
        (p.desc||'').toLowerCase().includes(ql) ||
        (p.developer||'').toLowerCase().includes(ql)
      );
      const unitMatches = units.filter(u =>
        (u.title||'').toLowerCase().includes(ql) ||
        (u.project||'').toLowerCase().includes(ql) ||
        (u.notes||'').toLowerCase().includes(ql)
      );

      const html = [];
      if (projMatches.length){
        html.push('<div><h4>مشاريع مطابقة</h4>');
        projMatches.forEach(p=>{
          html.push(`<div class="project-item" style="margin-top:8px">
            <div class="project-thumb"><img src="${p.thumb||'https://via.placeholder.com/400x300?text=No+Image'}" alt=""></div>
            <div class="project-info"><h3>${escapeHtml(p.name)}</h3><p>${escapeHtml(p.desc||'')}</p><div class="meta"><div>${escapeHtml(p.developer||'')}</div></div></div>
          </div>`);
        });
        html.push('</div>');
      }

      if (unitMatches.length){
        html.push('<div style="margin-top:8px"><h4>وحدات مطابقة</h4>');
        unitMatches.forEach(u=>{
          html.push(`<div class="project-item" style="margin-top:8px">
            <div class="project-thumb"><img src="https://via.placeholder.com/400x300?text=Unit" alt=""></div>
            <div class="project-info"><h3>${escapeHtml(u.title)}</h3><p>${escapeHtml(u.notes||'')}</p><div class="meta"><div>${escapeHtml(u.project||'')}</div><div style="margin-left:auto">${u.price?escapeHtml(u.price)+' EGP':''}</div></div></div>
          </div>`);
        });
        html.push('</div>');
      }

      if (html.length === 0) searchResults.innerHTML = '<p style="color:var(--muted)">لا توجد نتائج مطابقة.</p>';
      else searchResults.innerHTML = html.join('');
    }

    // ===== Helpers =====
    function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m] }) }
    function escapeJs(s){ return (s||'').replace(/"/g,'\\"').replace(/'/g,"\\'"); }

    // ===== Open project (عرض تفاصيل) =====
    function openProject(id){
      const p = projects.find(x=>x.id==id);
      if (!p) return alert('لم أجد المشروع.');
      // عرض تفصيلي سريع — يمكنك استبداله بصفحة منفصلة
      const html = `
        <div style="padding:12px">
          <h2>${escapeHtml(p.name)}</h2>
          <p><strong>المطور:</strong> ${escapeHtml(p.developer||'-')}</p>
          <p><strong>المنطقة:</strong> ${escapeHtml(p.area||'-')}</p>
          <p>${escapeHtml(p.desc||'')}</p>
          <p><a href="#" onclick="return false" style="color:var(--accent)">اتصل بالمطور</a></p>
        </div>
      `;
      const w = window.open('', '_blank', 'width=700,height=600');
      w.document.write('<meta charset="utf-8"><title>تفاصيل المشروع</title>'+html);
      w.document.close();
    }

    // ===== Contact button for unit =====
    function contactForUnit(id){
      const u = units.find(x=>x.id==id);
      if (!u) return alert('لم أجد الوحدة.');
      const body = `أنا مهتم بالوحدة: ${u.title}\\nالمشروع: ${u.project}\\nالسعر: ${u.price||'-'}`;
      // هنا ترسل الإيميل أو تفتح نافذة اتصال؛ نستخدم mailto كمثال
      window.location.href = 'mailto:info@islamproperty.com?subject='+encodeURIComponent('اهتمام بوحدة')+'&body='+encodeURIComponent(body);
    }

    // ===== Submit project form (يحفظ محليًا ثم يحاول POST للـ API) =====
    document.getElementById('submitProject').addEventListener('click', async () => {
      const name = document.getElementById('proj_name').value.trim();
      if (!name) return alert('اكتب اسم المشروع');
      const newP = {
        id: 'p_local_'+Date.now(),
        name,
        developer: document.getElementById('proj_dev').value.trim(),
        area: document.getElementById('proj_area').value.trim() || 'العين السخنة',
        desc: document.getElementById('proj_desc').value.trim(),
        thumb: document.getElementById('proj_thumb').value.trim()
      };
      // add locally and save
      projects.unshift(newP);
      localStorage.setItem('islam_projects', JSON.stringify(projects));
      renderProjects();
      alert('تم إضافة المشروع محليًا. إذا كان لديك API، سيتم إرسال الطلب أيضًا.');
      // try send to API (best-effort)
      try {
        await fetch(API_SUBMIT_PROJECT, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify(newP)
        });
      } catch(e){
        // ignore - best effort
      }
      // clear form
      document.getElementById('proj_name').value='';
      document.getElementById('proj_dev').value='';
      document.getElementById('proj_area').value='';
      document.getElementById('proj_desc').value='';
      document.getElementById('proj_thumb').value='';
    });

    // ===== Submit unit form =====
    document.getElementById('submitUnit').addEventListener('click', async () => {
      const title = document.getElementById('unit_title').value.trim();
      if (!title) return alert('اكتب عنوان الوحدة');
      const newU = {
        id: 'u_local_'+Date.now(),
        title,
        project: document.getElementById('unit_project').value.trim(),
        price: document.getElementById('unit_price').value.trim(),
        type: document.getElementById('unit_type').value,
        notes: document.getElementById('unit_notes').value.trim(),
        featured: false
      };
      units.unshift(newU);
      localStorage.setItem('islam_units', JSON.stringify(units));
      renderUnits();
      alert('تم إضافة الوحدة محليًا. سيتم محاولة إرسالها إلى API إن وُجد.');
      try {
        await fetch(API_SUBMIT_UNIT, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify(newU)
        });
      } catch(e){}
      document.getElementById('unit_title').value='';
      document.getElementById('unit_project').value='';
      document.getElementById('unit_price').value='';
      document.getElementById('unit_notes').value='';
    });

    // ===== Tabs filter =====
    tabs.forEach(btn=>{
      btn.addEventListener('click', () => {
        tabs.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.filter;
        renderProjects();
      });
    });

    // ===== Search events =====
    searchBtn.addEventListener('click', ()=> performSearch(searchInput.value));
    searchInput.addEventListener('keydown', (e)=> { if (e.key==='Enter') performSearch(searchInput.value); });

    // ===== Load more =====
    document.getElementById('loadMore').addEventListener('click', ()=>{
      itemsToShow += 6;
      renderProjects();
    });

    // ===== Add sample project button (تجريبي سريع) =====
    document.getElementById('addSampleBtn').addEventListener('click', ()=>{
      const sample = {
        id: 'p_sample_'+Date.now(),
        name: 'مشروع تجريبي جديد',
        developer: 'مطور تجريبي',
        type: 'developer',
        area: 'العين السخنة',
        desc: 'هذا مشروع مُضاف تلقائياً للتجربة.',
        thumb: 'https://via.placeholder.com/400x300?text=Sample'
      };
      projects.unshift(sample);
      localStorage.setItem('islam_projects', JSON.stringify(projects));
      renderProjects();
    });

    // ===== start =====
    fetchData();

    // ===== keyboard shortcuts: / focus البحث =====
    window.addEventListener('keypress', (e)=> {
      if (e.key === '/') { e.preventDefault(); searchInput.focus(); }
    });

    // ===== small note: لو عندك API أعدّل المسارات أعلاه =====
  </script>
</body>
</html>
