<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة التحكم - إدارة موقع العقارات</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .login-screen {
            padding: 60px 30px;
            text-align: center;
        }
        
        .login-box {
            max-width: 500px;
            margin: 0 auto;
            background: #f8f9fa;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .login-box h2 {
            color: #667eea;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .form-group {
            margin-bottom: 25px;
            text-align: right;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .dashboard {
            display: none;
        }
        
        .dashboard.active {
            display: block;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid #667eea;
            overflow-x: auto;
        }
        
        .nav-tab {
            padding: 20px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
            position: relative;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
            color: #667eea;
        }
        
        .nav-tab.active {
            color: #667eea;
            background: white;
        }
        
        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: #667eea;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.3s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .section-header h2 {
            color: #333;
            font-size: 24px;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s;
            position: relative;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .card p {
            color: #666;
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .card-actions .btn {
            padding: 10px 20px;
            font-size: 14px;
            flex: 1;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .modal-header h2 {
            color: #667eea;
            font-size: 28px;
        }
        
        .close-btn {
            background: #dc3545;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            line-height: 1;
            transition: all 0.3s;
        }
        
        .close-btn:hover {
            background: #c82333;
            transform: rotate(90deg);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .image-preview {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .image-preview img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }
        
        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px 50px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 2000;
            text-align: center;
        }
        
        .loading.active {
            display: block;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px 30px;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 3000;
            animation: slideInRight 0.3s;
            max-width: 400px;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .alert-success {
            background: #28a745;
            color: white;
        }
        
        .alert-error {
            background: #dc3545;
            color: white;
        }
        
        .user-info {
            background: white;
            padding: 15px 25px;
            margin: 20px 30px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .user-info strong {
            color: #667eea;
        }
        
        .image-input-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .add-image-btn {
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .add-image-btn:hover {
            background: #218838;
        }
        
        .image-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
        }
        
        .remove-image-btn {
            background: #dc3545;
            color: white;
            padding: 5px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .stat-card p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
            }
            
            .modal-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏢 لوحة التحكم الشاملة</h1>
            <p>إدارة كاملة لموقع العقارات - المشاريع، المناطق، الوحدات، والمحتوى</p>
        </div>

        <!-- شاشة تسجيل الدخول -->
        <div id="loginScreen" class="login-screen">
            <div class="login-box">
                <h2>🔐 تسجيل الدخول</h2>
                <div class="form-group">
                    <label>رمز GitHub Token:</label>
                    <input type="password" id="githubToken" placeholder="أدخل GitHub Token هنا">
                    <small style="display: block; margin-top: 10px; color: #666;">
                        احصل على التوكن من: github.com/settings/tokens
                    </small>
                </div>
                <div class="form-group">
                    <label>اسم المستودع:</label>
                    <input type="text" id="repoName" value="islamesmail-jpg/islamesmail-jpg.github.io" placeholder="username/repository">
                </div>
                <button onclick="login()" class="btn btn-primary">تسجيل الدخول 🚀</button>
            </div>
        </div>

        <!-- لوحة التحكم الرئيسية -->
        <div id="dashboard" class="dashboard">
            <div class="user-info">
                <div>
                    <strong>المستودع:</strong> <span id="repoDisplay"></span>
                </div>
                <button onclick="logout()" class="btn btn-danger">تسجيل الخروج</button>
            </div>

            <!-- إحصائيات سريعة -->
            <div style="padding: 0 30px;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="projectsCount">0</h3>
                        <p>المشاريع</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="areasCount">0</h3>
                        <p>المناطق</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="unitsCount">0</h3>
                        <p>الوحدات</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="roadsCount">0</h3>
                        <p>الطرق</p>
                    </div>
                </div>
            </div>

            <!-- التبويبات -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('projects')">📁 المشاريع</button>
                <button class="nav-tab" onclick="switchTab('areas')">📍 المناطق</button>
                <button class="nav-tab" onclick="switchTab('roads')">🛣️ الطرق</button>
                <button class="nav-tab" onclick="switchTab('units')">🏠 الوحدات</button>
                <button class="nav-tab" onclick="switchTab('pages')">📄 الصفحات</button>
                <button class="nav-tab" onclick="switchTab('settings')">⚙️ الإعدادات</button>
            </div>

            <!-- محتوى التبويبات -->
            <!-- تبويب المشاريع -->
            <div id="projectsTab" class="tab-content active">
                <div class="section-header">
                    <h2>إدارة المشاريع</h2>
                    <button onclick="openAddProjectModal()" class="btn btn-success">➕ إضافة مشروع جديد</button>
                </div>
                <div id="projectsList" class="cards-grid"></div>
            </div>

            <!-- تبويب المناطق -->
            <div id="areasTab" class="tab-content">
                <div class="section-header">
                    <h2>إدارة المناطق</h2>
                    <button onclick="openAddAreaModal()" class="btn btn-success">➕ إضافة منطقة جديدة</button>
                </div>
                <div id="areasList" class="cards-grid"></div>
            </div>

            <!-- تبويب الطرق -->
            <div id="roadsTab" class="tab-content">
                <div class="section-header">
                    <h2>إدارة الطرق</h2>
                    <button onclick="openAddRoadModal()" class="btn btn-success">➕ إضافة طريق جديد</button>
                </div>
                <div id="roadsList" class="cards-grid"></div>
            </div>

            <!-- تبويب الوحدات -->
            <div id="unitsTab" class="tab-content">
                <div class="section-header">
                    <h2>إدارة الوحدات</h2>
                    <button onclick="openAddUnitModal()" class="btn btn-success">➕ إضافة وحدة جديدة</button>
                </div>
                <div id="unitsList" class="cards-grid"></div>
            </div>

            <!-- تبويب الصفحات -->
            <div id="pagesTab" class="tab-content">
                <div class="section-header">
                    <h2>إدارة الصفحات</h2>
                    <button onclick="openAddPageModal()" class="btn btn-success">➕ إضافة صفحة جديدة</button>
                </div>
                <div id="pagesList" class="cards-grid"></div>
            </div>

            <!-- تبويب الإعدادات -->
            <div id="settingsTab" class="tab-content">
                <div class="section-header">
                    <h2>إعدادات الموقع</h2>
                </div>
                <div style="max-width: 800px;">
                    <div class="card">
                        <h3>معلومات الموقع</h3>
                        <div class="form-group">
                            <label>اسم الموقع:</label>
                            <input type="text" id="siteName" value="Islam Property">
                        </div>
                        <div class="form-group">
                            <label>وصف الموقع:</label>
                            <textarea id="siteDescription">موقع عقارات احترافي للعرض والبيع</textarea>
                        </div>
                        <div class="form-group">
                            <label>رقم الهاتف:</label>
                            <input type="text" id="sitePhone" value="+20 123 456 7890">
                        </div>
                        <div class="form-group">
                            <label>البريد الإلكتروني:</label>
                            <input type="email" id="siteEmail" value="info@islamproperty.com">
                        </div>
                        <button onclick="saveSettings()" class="btn btn-primary">💾 حفظ الإعدادات</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal إضافة/تعديل مشروع -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="projectModalTitle">إضافة مشروع جديد</h2>
                <button class="close-btn" onclick="closeModal('projectModal')">×</button>
            </div>
            <form onsubmit="saveProject(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>اسم المشروع: *</label>
                        <input type="text" id="projectName" required>
                    </div>
                    <div class="form-group">
                        <label>رابط الصفحة (slug): *</label>
                        <input type="text" id="projectSlug" required placeholder="project-name">
                    </div>
                </div>

                <div class="form-group">
                    <label>عنوان الصفحة: *</label>
                    <input type="text" id="projectTitle" required>
                </div>

                <div class="form-group">
                    <label>المنطقة: *</label>
                    <select id="projectArea" required>
                        <option value="">اختر المنطقة</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>القسم المعروض فيه:</label>
                    <select id="projectSection">
                        <option value="featured">مميز</option>
                        <option value="new">جديد</option>
                        <option value="popular">شائع</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>وصف كامل: *</label>
                    <textarea id="projectDescription" required></textarea>
                </div>

                <div class="image-input-group">
                    <label><strong>صور المشروع:</strong></label>
                    <div id="projectImagesContainer"></div>
                    <button type="button" onclick="addProjectImage()" class="add-image-btn">➕ إضافة صورة</button>
                </div>

                <div class="form-group">
                    <label>رابط فيديو المشروع (YouTube/Vimeo):</label>
                    <input type="url" id="projectVideo">
                </div>

                <div class="form-group">
                    <label>رابط صورة الماستر بلان:</label>
                    <input type="url" id="projectMasterplan">
                </div>

                <div class="form-group">
                    <label>اللوكيشن (رابط خريطة Google Maps):</label>
                    <input type="url" id="projectLocation">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>السعر من:</label>
                        <input type="number" id="projectPriceFrom">
                    </div>
                    <div class="form-group">
                        <label>السعر إلى:</label>
                        <input type="number" id="projectPriceTo">
                    </div>
                </div>

                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button type="submit" class="btn btn-primary">💾 حفظ المشروع</button>
                    <button type="button" onclick="closeModal('projectModal')" class="btn btn-secondary">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal إضافة/تعديل منطقة -->
    <div id="areaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="areaModalTitle">إضافة منطقة جديدة</h2>
                <button class="close-btn" onclick="closeModal('areaModal')">×</button>
            </div>
            <form onsubmit="saveArea(event)">
                <div class="form-group">
                    <label>اسم المنطقة: *</label>
                    <input type="text" id="areaName" required>
                </div>

                <div class="form-group">
                    <label>رابط الصفحة (slug): *</label>
                    <input type="text" id="areaSlug" required>
                </div>

                <div class="form-group">
                    <label>وصف المنطقة: *</label>
                    <textarea id="areaDescription" required></textarea>
                </div>

                <div class="image-input-group">
                    <label><strong>صور المنطقة:</strong></label>
                    <div id="areaImagesContainer"></div>
                    <button type="button" onclick="addAreaImage()" class="add-image-btn">➕ إضافة صورة</button>
                </div>

                <div class="form-group">
                    <label>رابط فيديو المنطقة:</label>
                    <input type="url" id="areaVideo">
                </div>

                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button type="submit" class="btn btn-primary">💾 حفظ المنطقة</button>
                    <button type="button" onclick="closeModal('areaModal')" class="btn btn-secondary">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal إضافة/تعديل طريق -->
    <div id="roadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="roadModalTitle">إضافة طريق جديد</h2>
                <button class="close-btn" onclick="closeModal('roadModal')">×</button>
            </div>
            <form onsubmit="saveRoad(event)">
                <div class="form-group">
                    <label>اسم الطريق: *</label>
                    <input type="text" id="roadName" required>
                </div>

                <div class="form-group">
                    <label>المنطقة التابع لها: *</label>
                    <select id="roadArea" required>
                        <option value="">اختر المنطقة</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>وصف الطريق: *</label>
                    <textarea id="roadDescription" required></textarea>
                </div>

                <div class="image-input-group">
                    <label><strong>صور الطريق:</strong></label>
                    <div id="roadImagesContainer"></div>
                    <button type="button" onclick="addRoadImage()" class="add-image-btn">➕ إضافة صورة</button>
                </div>

                <div class="form-group">
                    <label>المواصفات والمميزات:</label>
                    <textarea id="roadFeatures" placeholder="مثال: طريق مزدوج - إضاءة جيدة - قريب من الخدمات"></textarea>
                </div>

                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button type="submit" class="btn btn-primary">💾 حفظ الطريق</button>
                    <button type="button" onclick="closeModal('roadModal')" class="btn btn-secondary">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal إضافة/تعديل وحدة -->
    <div id="unitModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="unitModalTitle">إضافة وحدة جديدة</h2>
                <button class="close-btn" onclick="closeModal('unitModal')">×</button>
            </div>
            <form onsubmit="saveUnit(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>كود الوحدة: *</label>
                        <input type="text" id="unitCode" required placeholder="UNIT-001">
                    </div>
                    <div class="form-group">
                        <label>رابط الصفحة (slug): *</label>
                        <input type="text" id="unitSlug" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>عنوان الوحدة: *</label>
                    <input type="text" id="unitTitle" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>المشروع: *</label>
                        <select id="unitProject" required>
                            <option value="">اختر المشروع</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>نوع الوحدة: *</label>
                        <select id="unitType" required>
                            <option value="">اختر النوع</option>
                            <option value="apartment">شقة</option>
                            <option value="villa">فيلا</option>
                            <option value="duplex">دوبلكس</option>
                            <option value="penthouse">بنتهاوس</option>
                            <option value="studio">استوديو</option>
                            <option value="townhouse">تاون هاوس</option>
                            <option value="chalet">شاليه</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>وصف كامل للوحدة: *</label>
                    <textarea id="unitDescription" required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>المساحة (متر مربع): *</label>
                        <input type="number" id="unitArea" required>
                    </div>
                    <div class="form-group">
                        <label>عدد الغرف:</label>
                        <input type="number" id="unitRooms">
                    </div>
                    <div class="form-group">
                        <label>عدد الحمامات:</label>
                        <input type="number" id="unitBathrooms">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>السعر الكامل: *</label>
                        <input type="number" id="unitPrice" required>
                    </div>
                    <div class="form-group">
                        <label>المقدم:</label>
                        <input type="number" id="unitDownPayment">
                    </div>
                </div>

                <div class="form-group">
                    <label>تفاصيل السداد الكاملة:</label>
                    <textarea id="unitPaymentDetails" placeholder="مثال: مقدم 10% - قسط على 5 سنوات - دون فوائد"></textarea>
                </div>

                <div class="image-input-group">
                    <label><strong>صور الوحدة:</strong></label>
                    <div id="unitImagesContainer"></div>
                    <button type="button" onclick="addUnitImage()" class="add-image-btn">➕ إضافة صورة</button>
                </div>

                <div class="form-group">
                    <label>مميزات إضافية (كل ميزة في سطر):</label>
                    <textarea id="unitFeatures" placeholder="مثال:&#10;- تشطيب سوبر لوكس&#10;- حديقة خاصة&#10;- موقف سيارة"></textarea>
                </div>

                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button type="submit" class="btn btn-primary">💾 حفظ الوحدة</button>
                    <button type="button" onclick="closeModal('unitModal')" class="btn btn-secondary">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading">
        <div class="loading-spinner"></div>
        <p>جاري الحفظ...</p>
    </div>

    <script>
        // البيانات المحلية
        let githubToken = '';
        let repoName = '';
        let currentEditId = null;
        let currentEditType = null;
        
        let projects = [];
        let areas = [];
        let roads = [];
        let units = [];
        let pages = [];

        // تسجيل الدخول
        function login() {
            githubToken = document.getElementById('githubToken').value.trim();
            repoName = document.getElementById('repoName').value.trim();
            
            if (!githubToken || !repoName) {
                showAlert('error', 'يرجى إدخال GitHub Token واسم المستودع');
                return;
            }
            
            document.getElementById('repoDisplay').textContent = repoName;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');
            
            loadAllData();
            showAlert('success', 'تم تسجيل الدخول بنجاح! 🎉');
        }

        // تسجيل الخروج
        function logout() {
            if (confirm('هل أنت متأكد من تسجيل الخروج؟')) {
                githubToken = '';
                repoName = '';
                document.getElementById('loginScreen').style.display = 'block';
                document.getElementById('dashboard').classList.remove('active');
                document.getElementById('githubToken').value = '';
            }
        }

        // تحميل جميع البيانات
        async function loadAllData() {
            showLoading(true);
            try {
                await Promise.all([
                    loadProjects(),
                    loadAreas(),
                    loadRoads(),
                    loadUnits()
                ]);
                updateStats();
            } catch (error) {
                console.error('خطأ في تحميل البيانات:', error);
                showAlert('error', 'حدث خطأ في تحميل البيانات');
            } finally {
                showLoading(false);
            }
        }

        // تحميل المشاريع
        async function loadProjects() {
            try {
                const data = await fetchFromGitHub('data/projects.json');
                projects = data || [];
                renderProjects();
            } catch (error) {
                projects = [];
                renderProjects();
            }
        }

        // تحميل المناطق
        async function loadAreas() {
            try {
                const data = await fetchFromGitHub('data/areas.json');
                areas = data || getDefaultAreas();
                renderAreas();
                updateAreaSelects();
            } catch (error) {
                areas = getDefaultAreas();
                renderAreas();
                updateAreaSelects();
            }
        }

        // تحميل الطرق
        async function loadRoads() {
            try {
                const data = await fetchFromGitHub('data/roads.json');
                roads = data || [];
                renderRoads();
            } catch (error) {
                roads = [];
                renderRoads();
            }
        }

        // تحميل الوحدات
        async function loadUnits() {
            try {
                const data = await fetchFromGitHub('data/units.json');
                units = data || [];
                renderUnits();
                updateProjectSelects();
            } catch (error) {
                units = [];
                renderUnits();
            }
        }

        // المناطق الافتراضية
        function getDefaultAreas() {
            return [
                {
                    id: 'ain-sokhna',
                    name: 'العين السخنة',
                    slug: 'ain-sokhna',
                    description: 'منطقة ساحلية متميزة على البحر الأحمر',
                    images: [],
                    video: ''
                },
                {
                    id: 'north-coast',
                    name: 'الساحل الشمالي',
                    slug: 'north-coast',
                    description: 'أجمل شواطئ مصر على البحر المتوسط',
                    images: [],
                    video: ''
                },
                {
                    id: 'new-cairo',
                    name: 'القاهرة الجديدة',
                    slug: 'new-cairo',
                    description: 'منطقة سكنية راقية شرق القاهرة',
                    images: [],
                    video: ''
                },
                {
                    id: 'new-capital',
                    name: 'العاصمة الإدارية',
                    slug: 'new-capital',
                    description: 'عاصمة مصر الجديدة',
                    images: [],
                    video: ''
                },
                {
                    id: 'future-city',
                    name: 'مدينة المستقبل',
                    slug: 'future-city',
                    description: 'مدينة حديثة متكاملة',
                    images: [],
                    video: ''
                },
                {
                    id: 'new-heliopolis',
                    name: 'هليوبوليس الجديدة',
                    slug: 'new-heliopolis',
                    description: 'امتداد راقي لمصر الجديدة',
                    images: [],
                    video: ''
                }
            ];
        }

        // عرض المشاريع
        function renderProjects() {
            const container = document.getElementById('projectsList');
            if (projects.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">لا توجد مشاريع حالياً. ابدأ بإضافة مشروع جديد!</p>';
                return;
            }
            
            container.innerHTML = projects.map(project => `
                <div class="card">
                    <h3>${project.name}</h3>
                    <p><strong>المنطقة:</strong> ${getAreaName(project.area)}</p>
                    <p><strong>القسم:</strong> ${getSectionName(project.section)}</p>
                    <p>${project.description.substring(0, 100)}...</p>
                    ${project.images && project.images.length > 0 ? `<div class="image-preview">${project.images.slice(0, 3).map(img => `<img src="${img}" alt="${project.name}">`).join('')}</div>` : ''}
                    <div class="card-actions">
                        <button onclick="editProject('${project.id}')" class="btn btn-primary">تعديل</button>
                        <button onclick="deleteProject('${project.id}')" class="btn btn-danger">حذف</button>
                    </div>
                </div>
            `).join('');
        }

        // عرض المناطق
        function renderAreas() {
            const container = document.getElementById('areasList');
            if (areas.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">لا توجد مناطق حالياً.</p>';
                return;
            }
            
            container.innerHTML = areas.map(area => `
                <div class="card">
                    <h3>${area.name}</h3>
                    <p>${area.description}</p>
                    ${area.images && area.images.length > 0 ? `<div class="image-preview">${area.images.slice(0, 3).map(img => `<img src="${img}" alt="${area.name}">`).join('')}</div>` : ''}
                    <div class="card-actions">
                        <button onclick="editArea('${area.id}')" class="btn btn-primary">تعديل</button>
                        <button onclick="deleteArea('${area.id}')" class="btn btn-danger">حذف</button>
                    </div>
                </div>
            `).join('');
        }

        // عرض الطرق
        function renderRoads() {
            const container = document.getElementById('roadsList');
            if (roads.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">لا توجد طرق حالياً. ابدأ بإضافة طريق جديد!</p>';
                return;
            }
            
            container.innerHTML = roads.map(road => `
                <div class="card">
                    <h3>${road.name}</h3>
                    <p><strong>المنطقة:</strong> ${getAreaName(road.area)}</p>
                    <p>${road.description}</p>
                    ${road.images && road.images.length > 0 ? `<div class="image-preview">${road.images.slice(0, 3).map(img => `<img src="${img}" alt="${road.name}">`).join('')}</div>` : ''}
                    <div class="card-actions">
                        <button onclick="editRoad('${road.id}')" class="btn btn-primary">تعديل</button>
                        <button onclick="deleteRoad('${road.id}')" class="btn btn-danger">حذف</button>
                    </div>
                </div>
            `).join('');
        }

        // عرض الوحدات
        function renderUnits() {
            const container = document.getElementById('unitsList');
            if (units.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">لا توجد وحدات حالياً. ابدأ بإضافة وحدة جديدة!</p>';
                return;
            }
            
            container.innerHTML = units.map(unit => `
                <div class="card">
                    <h3>${unit.title}</h3>
                    <p><strong>الكود:</strong> ${unit.code}</p>
                    <p><strong>المشروع:</strong> ${getProjectName(unit.project)}</p>
                    <p><strong>النوع:</strong> ${getUnitTypeName(unit.type)}</p>
                    <p><strong>المساحة:</strong> ${unit.area} م²</p>
                    <p><strong>السعر:</strong> ${formatPrice(unit.price)} جنيه</p>
                    <div class="card-actions">
                        <button onclick="editUnit('${unit.id}')" class="btn btn-primary">تعديل</button>
                        <button onclick="deleteUnit('${unit.id}')" class="btn btn-danger">حذف</button>
                    </div>
                </div>
            `).join('');
        }

        // تحديث قوائم المشاريع
        function updateProjectSelects() {
            const select = document.getElementById('unitProject');
            const currentValue = select.value;
            select.innerHTML = '<option value="">اختر المشروع</option>' + 
                projects.map(project => `<option value="${project.id}">${project.name}</option>`).join('');
            select.value = currentValue;
        }

        // وظائف مساعدة
        function getAreaName(areaId) {
            const area = areas.find(a => a.id === areaId);
            return area ? area.name : 'غير محدد';
        }

        function getProjectName(projectId) {
            const project = projects.find(p => p.id === projectId);
            return project ? project.name : 'غير محدد';
        }

        function getSectionName(section) {
            const sections = {
                'featured': 'مميز',
                'new': 'جديد',
                'popular': 'شائع'
            };
            return sections[section] || section;
        }

        function getUnitTypeName(type) {
            const types = {
                'apartment': 'شقة',
                'villa': 'فيلا',
                'duplex': 'دوبلكس',
                'penthouse': 'بنتهاوس',
                'studio': 'استوديو',
                'townhouse': 'تاون هاوس',
                'chalet': 'شاليه'
            };
            return types[type] || type;
        }

        function formatPrice(price) {
            return new Intl.NumberFormat('ar-EG').format(price);
        }

        // تعديل المشروع
        function editProject(id) {
            const project = projects.find(p => p.id === id);
            if (!project) return;
            
            currentEditId = id;
            currentEditType = 'project';
            document.getElementById('projectModalTitle').textContent = 'تعديل المشروع';
            document.getElementById('projectName').value = project.name;
            document.getElementById('projectSlug').value = project.slug;
            document.getElementById('projectTitle').value = project.title;
            document.getElementById('projectArea').value = project.area;
            document.getElementById('projectSection').value = project.section;
            document.getElementById('projectDescription').value = project.description;
            document.getElementById('projectVideo').value = project.video || '';
            document.getElementById('projectMasterplan').value = project.masterplan || '';
            document.getElementById('projectLocation').value = project.location || '';
            document.getElementById('projectPriceFrom').value = project.priceFrom || '';
            document.getElementById('projectPriceTo').value = project.priceTo || '';
            
            const container = document.getElementById('projectImagesContainer');
            container.innerHTML = '';
            if (project.images && project.images.length > 0) {
                project.images.forEach(img => {
                    const div = document.createElement('div');
                    div.className = 'image-item';
                    div.innerHTML = `
                        <input type="url" value="${img}" style="width: 100%;">
                        <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
                    `;
                    container.appendChild(div);
                });
            }
            
            openModal('projectModal');
        }

        // حذف المشروع
        async function deleteProject(id) {
            if (!confirm('هل أنت متأكد من حذف هذا المشروع؟')) return;
            
            projects = projects.filter(p => p.id !== id);
            await saveToGitHub('data/projects.json', projects, 'حذف مشروع');
            renderProjects();
            updateStats();
        }

        // تعديل المنطقة
        function editArea(id) {
            const area = areas.find(a => a.id === id);
            if (!area) return;
            
            currentEditId = id;
            currentEditType = 'area';
            document.getElementById('areaModalTitle').textContent = 'تعديل المنطقة';
            document.getElementById('areaName').value = area.name;
            document.getElementById('areaSlug').value = area.slug;
            document.getElementById('areaDescription').value = area.description;
            document.getElementById('areaVideo').value = area.video || '';
            
            const container = document.getElementById('areaImagesContainer');
            container.innerHTML = '';
            if (area.images && area.images.length > 0) {
                area.images.forEach(img => {
                    const div = document.createElement('div');
                    div.className = 'image-item';
                    div.innerHTML = `
                        <input type="url" value="${img}" style="width: 100%;">
                        <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
                    `;
                    container.appendChild(div);
                });
            }
            
            openModal('areaModal');
        }

        // حذف المنطقة
        async function deleteArea(id) {
            if (!confirm('هل أنت متأكد من حذف هذه المنطقة؟')) return;
            
            areas = areas.filter(a => a.id !== id);
            await saveToGitHub('data/areas.json', areas, 'حذف منطقة');
            renderAreas();
            updateAreaSelects();
            updateStats();
        }

        // تعديل الطريق
        function editRoad(id) {
            const road = roads.find(r => r.id === id);
            if (!road) return;
            
            currentEditId = id;
            currentEditType = 'road';
            document.getElementById('roadModalTitle').textContent = 'تعديل الطريق';
            document.getElementById('roadName').value = road.name;
            document.getElementById('roadArea').value = road.area;
            document.getElementById('roadDescription').value = road.description;
            document.getElementById('roadFeatures').value = road.features || '';
            
            const container = document.getElementById('roadImagesContainer');
            container.innerHTML = '';
            if (road.images && road.images.length > 0) {
                road.images.forEach(img => {
                    const div = document.createElement('div');
                    div.className = 'image-item';
                    div.innerHTML = `
                        <input type="url" value="${img}" style="width: 100%;">
                        <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
                    `;
                    container.appendChild(div);
                });
            }
            
            openModal('roadModal');
        }

        // حذف الطريق
        async function deleteRoad(id) {
            if (!confirm('هل أنت متأكد من حذف هذا الطريق؟')) return;
            
            roads = roads.filter(r => r.id !== id);
            await saveToGitHub('data/roads.json', roads, 'حذف طريق');
            renderRoads();
            updateStats();
        }

        // تعديل الوحدة
        function editUnit(id) {
            const unit = units.find(u => u.id === id);
            if (!unit) return;
            
            currentEditId = id;
            currentEditType = 'unit';
            document.getElementById('unitModalTitle').textContent = 'تعديل الوحدة';
            document.getElementById('unitCode').value = unit.code;
            document.getElementById('unitSlug').value = unit.slug;
            document.getElementById('unitTitle').value = unit.title;
            document.getElementById('unitProject').value = unit.project;
            document.getElementById('unitType').value = unit.type;
            document.getElementById('unitDescription').value = unit.description;
            document.getElementById('unitArea').value = unit.area;
            document.getElementById('unitRooms').value = unit.rooms || '';
            document.getElementById('unitBathrooms').value = unit.bathrooms || '';
            document.getElementById('unitPrice').value = unit.price;
            document.getElementById('unitDownPayment').value = unit.downPayment || '';
            document.getElementById('unitPaymentDetails').value = unit.paymentDetails || '';
            document.getElementById('unitFeatures').value = unit.features || '';
            
            const container = document.getElementById('unitImagesContainer');
            container.innerHTML = '';
            if (unit.images && unit.images.length > 0) {
                unit.images.forEach(img => {
                    const div = document.createElement('div');
                    div.className = 'image-item';
                    div.innerHTML = `
                        <input type="url" value="${img}" style="width: 100%;">
                        <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
                    `;
                    container.appendChild(div);
                });
            }
            
            openModal('unitModal');
        }

        // حذف الوحدة
        async function deleteUnit(id) {
            if (!confirm('هل أنت متأكد من حذف هذه الوحدة؟')) return;
            
            units = units.filter(u => u.id !== id);
            await saveToGitHub('data/units.json', units, 'حذف وحدة');
            renderUnits();
            updateStats();
        }

        // حفظ الإعدادات
        async function saveSettings() {
            const settings = {
                siteName: document.getElementById('siteName').value,
                siteDescription: document.getElementById('siteDescription').value,
                sitePhone: document.getElementById('sitePhone').value,
                siteEmail: document.getElementById('siteEmail').value
            };
            
            await saveToGitHub('data/settings.json', settings, 'تحديث إعدادات الموقع');
            showAlert('success', 'تم حفظ الإعدادات بنجاح! ✅');
        }

        // وظائف GitHub API
        async function fetchFromGitHub(path) {
            const response = await fetch(`https://api.github.com/repos/${repoName}/contents/${path}`, {
                headers: {
                    'Authorization': `token ${githubToken}`,
                    'Accept': 'application/vnd.github.v3+json'
                }
            });
            
            if (!response.ok) {
                throw new Error('فشل في تحميل البيانات');
            }
            
            const data = await response.json();
            const content = atob(data.content);
            return JSON.parse(content);
        }

        async function saveToGitHub(path, data, message) {
            showLoading(true);
            
            try {
                // الحصول على SHA للملف الحالي
                let sha = '';
                try {
                    const response = await fetch(`https://api.github.com/repos/${repoName}/contents/${path}`, {
                        headers: {
                            'Authorization': `token ${githubToken}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    if (response.ok) {
                        const fileData = await response.json();
                        sha = fileData.sha;
                    }
                } catch (e) {
                    // الملف غير موجود، سيتم إنشاؤه
                }
                
                // حفظ البيانات
                const content = btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2))));
                const response = await fetch(`https://api.github.com/repos/${repoName}/contents/${path}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Content-Type': 'application/json',
                        'Accept': 'application/vnd.github.v3+json'
                    },
                    body: JSON.stringify({
                        message: message,
                        content: content,
                        sha: sha || undefined
                    })
                });
                
                if (!response.ok) {
                    throw new Error('فشل في الحفظ');
                }
                
                showAlert('success', 'تم الحفظ بنجاح! ✅');
            } catch (error) {
                console.error('خطأ في الحفظ:', error);
                showAlert('error', 'حدث خطأ أثناء الحفظ: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // فتح نافذة إضافة صفحة
        function openAddPageModal() {
            showAlert('error', 'هذه الميزة قيد التطوير');
        }

        // إغلاق النافذة عند النقر خارجها
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }

        // تحديث slug تلقائياً
        document.addEventListener('DOMContentLoaded', function() {
            const nameInputs = {
                'projectName': 'projectSlug',
                'areaName': 'areaSlug',
                'unitTitle': 'unitSlug'
            };
            
            Object.keys(nameInputs).forEach(nameId => {
                const nameInput = document.getElementById(nameId);
                const slugInput = document.getElementById(nameInputs[nameId]);
                
                if (nameInput && slugInput) {
                    nameInput.addEventListener('input', function() {
                        if (!currentEditId) {
                            const slug = this.value
                                .toLowerCase()
                                .replace(/\s+/g, '-')
                                .replace(/[^\u0621-\u064Aa-z0-9\-]/g, '');
                            slugInput.value = slug;
                        }
                    });
                }
            });
        });
    </script>
</body>
</html> الإحصائيات
        function updateStats() {
            document.getElementById('projectsCount').textContent = projects.length;
            document.getElementById('areasCount').textContent = areas.length;
            document.getElementById('unitsCount').textContent = units.length;
            document.getElementById('roadsCount').textContent = roads.length;
        }

        // فتح نافذة إضافة مشروع
        function openAddProjectModal() {
            currentEditId = null;
            currentEditType = 'project';
            document.getElementById('projectModalTitle').textContent = 'إضافة مشروع جديد';
            document.getElementById('projectName').value = '';
            document.getElementById('projectSlug').value = '';
            document.getElementById('projectTitle').value = '';
            document.getElementById('projectArea').value = '';
            document.getElementById('projectSection').value = 'featured';
            document.getElementById('projectDescription').value = '';
            document.getElementById('projectVideo').value = '';
            document.getElementById('projectMasterplan').value = '';
            document.getElementById('projectLocation').value = '';
            document.getElementById('projectPriceFrom').value = '';
            document.getElementById('projectPriceTo').value = '';
            document.getElementById('projectImagesContainer').innerHTML = '';
            openModal('projectModal');
        }

        // حفظ المشروع
        async function saveProject(event) {
            event.preventDefault();
            
            const images = [];
            document.querySelectorAll('#projectImagesContainer input').forEach(input => {
                if (input.value.trim()) images.push(input.value.trim());
            });
            
            const projectData = {
                id: currentEditId || 'project-' + Date.now(),
                name: document.getElementById('projectName').value,
                slug: document.getElementById('projectSlug').value,
                title: document.getElementById('projectTitle').value,
                area: document.getElementById('projectArea').value,
                section: document.getElementById('projectSection').value,
                description: document.getElementById('projectDescription').value,
                images: images,
                video: document.getElementById('projectVideo').value,
                masterplan: document.getElementById('projectMasterplan').value,
                location: document.getElementById('projectLocation').value,
                priceFrom: document.getElementById('projectPriceFrom').value,
                priceTo: document.getElementById('projectPriceTo').value,
                createdAt: currentEditId ? (projects.find(p => p.id === currentEditId)?.createdAt || new Date().toISOString()) : new Date().toISOString()
            };
            
            if (currentEditId) {
                const index = projects.findIndex(p => p.id === currentEditId);
                projects[index] = projectData;
            } else {
                projects.push(projectData);
            }
            
            await saveToGitHub('data/projects.json', projects, currentEditId ? 'تحديث مشروع' : 'إضافة مشروع جديد');
            closeModal('projectModal');
            renderProjects();
            updateStats();
        }

        // إضافة حقل صورة للمشروع
        function addProjectImage() {
            const container = document.getElementById('projectImagesContainer');
            const div = document.createElement('div');
            div.className = 'image-item';
            div.innerHTML = `
                <input type="url" placeholder="رابط الصورة" style="width: 100%;">
                <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
            `;
            container.appendChild(div);
        }

        // فتح نافذة إضافة منطقة
        function openAddAreaModal() {
            currentEditId = null;
            currentEditType = 'area';
            document.getElementById('areaModalTitle').textContent = 'إضافة منطقة جديدة';
            document.getElementById('areaName').value = '';
            document.getElementById('areaSlug').value = '';
            document.getElementById('areaDescription').value = '';
            document.getElementById('areaVideo').value = '';
            document.getElementById('areaImagesContainer').innerHTML = '';
            openModal('areaModal');
        }

        // حفظ المنطقة
        async function saveArea(event) {
            event.preventDefault();
            
            const images = [];
            document.querySelectorAll('#areaImagesContainer input').forEach(input => {
                if (input.value.trim()) images.push(input.value.trim());
            });
            
            const areaData = {
                id: currentEditId || 'area-' + Date.now(),
                name: document.getElementById('areaName').value,
                slug: document.getElementById('areaSlug').value,
                description: document.getElementById('areaDescription').value,
                images: images,
                video: document.getElementById('areaVideo').value
            };
            
            if (currentEditId) {
                const index = areas.findIndex(a => a.id === currentEditId);
                areas[index] = areaData;
            } else {
                areas.push(areaData);
            }
            
            await saveToGitHub('data/areas.json', areas, currentEditId ? 'تحديث منطقة' : 'إضافة منطقة جديدة');
            closeModal('areaModal');
            renderAreas();
            updateAreaSelects();
            updateStats();
        }

        // إضافة حقل صورة للمنطقة
        function addAreaImage() {
            const container = document.getElementById('areaImagesContainer');
            const div = document.createElement('div');
            div.className = 'image-item';
            div.innerHTML = `
                <input type="url" placeholder="رابط الصورة" style="width: 100%;">
                <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
            `;
            container.appendChild(div);
        }

        // فتح نافذة إضافة طريق
        function openAddRoadModal() {
            currentEditId = null;
            currentEditType = 'road';
            document.getElementById('roadModalTitle').textContent = 'إضافة طريق جديد';
            document.getElementById('roadName').value = '';
            document.getElementById('roadArea').value = '';
            document.getElementById('roadDescription').value = '';
            document.getElementById('roadFeatures').value = '';
            document.getElementById('roadImagesContainer').innerHTML = '';
            openModal('roadModal');
        }

        // حفظ الطريق
        async function saveRoad(event) {
            event.preventDefault();
            
            const images = [];
            document.querySelectorAll('#roadImagesContainer input').forEach(input => {
                if (input.value.trim()) images.push(input.value.trim());
            });
            
            const roadData = {
                id: currentEditId || 'road-' + Date.now(),
                name: document.getElementById('roadName').value,
                area: document.getElementById('roadArea').value,
                description: document.getElementById('roadDescription').value,
                features: document.getElementById('roadFeatures').value,
                images: images
            };
            
            if (currentEditId) {
                const index = roads.findIndex(r => r.id === currentEditId);
                roads[index] = roadData;
            } else {
                roads.push(roadData);
            }
            
            await saveToGitHub('data/roads.json', roads, currentEditId ? 'تحديث طريق' : 'إضافة طريق جديد');
            closeModal('roadModal');
            renderRoads();
            updateStats();
        }

        // إضافة حقل صورة للطريق
        function addRoadImage() {
            const container = document.getElementById('roadImagesContainer');
            const div = document.createElement('div');
            div.className = 'image-item';
            div.innerHTML = `
                <input type="url" placeholder="رابط الصورة" style="width: 100%;">
                <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
            `;
            container.appendChild(div);
        }

        // فتح نافذة إضافة وحدة
        function openAddUnitModal() {
            currentEditId = null;
            currentEditType = 'unit';
            document.getElementById('unitModalTitle').textContent = 'إضافة وحدة جديدة';
            document.getElementById('unitCode').value = '';
            document.getElementById('unitSlug').value = '';
            document.getElementById('unitTitle').value = '';
            document.getElementById('unitProject').value = '';
            document.getElementById('unitType').value = '';
            document.getElementById('unitDescription').value = '';
            document.getElementById('unitArea').value = '';
            document.getElementById('unitRooms').value = '';
            document.getElementById('unitBathrooms').value = '';
            document.getElementById('unitPrice').value = '';
            document.getElementById('unitDownPayment').value = '';
            document.getElementById('unitPaymentDetails').value = '';
            document.getElementById('unitFeatures').value = '';
            document.getElementById('unitImagesContainer').innerHTML = '';
            openModal('unitModal');
        }

        // حفظ الوحدة
        async function saveUnit(event) {
            event.preventDefault();
            
            const images = [];
            document.querySelectorAll('#unitImagesContainer input').forEach(input => {
                if (input.value.trim()) images.push(input.value.trim());
            });
            
            const unitData = {
                id: currentEditId || 'unit-' + Date.now(),
                code: document.getElementById('unitCode').value,
                slug: document.getElementById('unitSlug').value,
                title: document.getElementById('unitTitle').value,
                project: document.getElementById('unitProject').value,
                type: document.getElementById('unitType').value,
                description: document.getElementById('unitDescription').value,
                area: document.getElementById('unitArea').value,
                rooms: document.getElementById('unitRooms').value,
                bathrooms: document.getElementById('unitBathrooms').value,
                price: document.getElementById('unitPrice').value,
                downPayment: document.getElementById('unitDownPayment').value,
                paymentDetails: document.getElementById('unitPaymentDetails').value,
                features: document.getElementById('unitFeatures').value,
                images: images
            };
            
            if (currentEditId) {
                const index = units.findIndex(u => u.id === currentEditId);
                units[index] = unitData;
            } else {
                units.push(unitData);
            }
            
            await saveToGitHub('data/units.json', units, currentEditId ? 'تحديث وحدة' : 'إضافة وحدة جديدة');
            closeModal('unitModal');
            renderUnits();
            updateStats();
        }

        // إضافة حقل صورة للوحدة
        function addUnitImage() {
            const container = document.getElementById('unitImagesContainer');
            const div = document.createElement('div');
            div.className = 'image-item';
            div.innerHTML = `
                <input type="url" placeholder="رابط الصورة" style="width: 100%;">
                <button type="button" class="remove-image-btn" onclick="this.parentElement.remove()">حذف</button>
            `;
            container.appendChild(div);
        }

        // التبديل بين التبويبات
        function switchTab(tabName) {
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // فتح/إغلاق النافذة المنبثقة
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // عرض/إخفاء شاشة التحميل
        function showLoading(show) {
            document.getElementById('loadingSpinner').classList.toggle('active', show);
        }

        // عرض رسالة تنبيه
        function showAlert(type, message) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            document.body.appendChild(alert);
            
            setTimeout(() => alert.remove(), 3000);
        }

        // تحديث قوائم المناطق
        function updateAreaSelects() {
            const selects = [document.getElementById('projectArea'), document.getElementById('roadArea')];
            selects.forEach(select => {
                const currentValue = select.value;
                select.innerHTML = '<option value="">اختر المنطقة</option>' + 
                    areas.map(area => `<option value="${area.id}">${area.name}</option>`).join('');
                select.value = currentValue;
            });
        }

        // تحديث
