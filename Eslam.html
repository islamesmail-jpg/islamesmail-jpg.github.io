---
layout: none
title: "شاليه للبيع مشروع مورانو وادي دجلة العين السخنة - 3 غرف + ناني | Islam Real Estate"
permalink: /Eslam.html
---

<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>شاليه للبيع مشروع مورانو وادي دجلة العين السخنة - كود #101 | Islam Real Estate</title>
<meta name="description" content="شاليه فاخر 145 م² للبيع في مشروع مورانو وادي دجلة العين السخنة، 3 غرف نوم + غرفة مربية (ناني)، 2 حمام. مقدم 0% وأقساط حتى 8 سنوات (32 قسط). استلام فوري من المطور. احجز وحدتك الآن.">
<meta property="og:title" content="شاليه للبيع مشروع مورانو وادي دجلة العين السخنة - كود #101">
<meta property="og:description" content="احجز شاليهك الآن في مشروع مورانو وادي دجلة بمقدم 0% وأنظمة سداد حتى 8 سنوات.">
<link rel="icon" href="https://f.top4top.io/p_3562107rr0.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- Swiper (slider - يدعم السحب) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
<!-- Fancybox (لايت بوكس محترم) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css"/>

<style>
/* === ألوان ونمط عام (حافظت على معظم التنسيق الأصلي مع تعديلات المطلوب) === */
:root{
  --wrap:1180px; --line:#e5e7eb;
  --ink:#212529;
  --muted:#6c757d;
  --primary-blue:#0056b3;
  --accent-green:#28a745;
  --accent-red:#dc3545;
  --shadow:0 10px 25px rgba(0,0,0,.08);
  --radius:10px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:#f8f9fa;
  color:var(--ink);font-family:"Cairo",system-ui,Segoe UI,Roboto,Arial;
  line-height:1.7;font-size:16px;
}
a{color:var(--primary-blue);text-decoration:none;transition:color .3s}
a:hover{color:#003d80}

/* Search row */
.search-row{border-bottom:1px solid var(--line);padding:15px 0;text-align:center;background:#fff;}
.search-wrap{max-width:980px;margin:0 auto;position:relative;padding:0 15px}
#siteSearch{width:100%;max-width:520px;padding:12px 20px;border:1px solid var(--line);border-radius:25px;font-weight:600;font-size:16px;box-shadow:0 2px 5px rgba(0,0,0,.05);color:var(--ink)}
#siteSearch:focus{border-color:var(--primary-blue);box-shadow:0 0 0 3px rgba(0,86,179,.2)}
#suggest{position:absolute;left:0;right:0;top:calc(100% + 10px);background:#fff;border:1px solid var(--line);border-radius:var(--radius);display:none;z-index:1200;overflow:hidden;box-shadow:var(--shadow)}
#suggest a{display:block;padding:12px 14px;font-weight:600;color:var(--ink);cursor:pointer}
#suggest a:hover{background:#e9ecef}

/* Container */
.container{max-width:var(--wrap);margin:24px auto;padding:0 15px}
.breadcrumb{color:var(--muted);font-size:14px;text-align:right;margin-bottom:10px}
.unit-title-block{text-align:center;margin-bottom:20px;}
.unit-title-block h1{margin:0;font-size:26px;font-weight:900;color:var(--ink)}
.unit-title-block .small-text{color:var(--muted);font-size:15px;margin-top:5px;}

/* === Swiper slider (دمجته داخل image-slider) === */
.image-slider{position:relative;margin:0 auto;max-width:980px;border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);}
.swiper .swiper-slide img{width:100%;height:400px;object-fit:cover;border-radius:var(--radius);display:block}
@media(max-width:720px){ .swiper .swiper-slide img{height:250px;object-fit:cover} }

/* مواصفات أصغر */
.specs-section{display:flex;justify-content:center;flex-wrap:wrap;gap:20px;padding:12px;background:#fff;border-radius:var(--radius);border:1px solid var(--line);margin-top:14px}
.spec-item{text-align:center;font-weight:700;color:var(--ink);font-size:14px}
.spec-item img{width:22px;height:22px;margin-bottom:6px} /* صغر الأيقونات */

/* السعر - نص الحجم */
.price-tag{display:inline-block;text-align:center;padding:8px 14px;background:var(--primary-blue);color:#fff;font-size:16px;font-weight:900;border-radius:var(--radius);box-shadow:0 4px 10px rgba(0,86,179,.3);margin-top:14px;max-width:50%;}

/* أزرار الاتصال - جنب بعض وحجم أصغر */
.contact-actions{display:flex;gap:12px;margin-top:12px;justify-content:center;align-items:center;flex-wrap:nowrap}
.btn-contact{padding:10px 12px;border-radius:20px;font-weight:800;cursor:pointer;border:none;font-size:14px;display:inline-flex;align-items:center;gap:8px;color:#fff}
.btn-whatsapp{background:var(--accent-green)}
.btn-whatsapp:hover{background:#218838}
.btn-phone{background:var(--accent-red)}
.btn-phone:hover{background:#c82333}

/* المحتوى الأساسي */
.main-content{display:grid;grid-template-columns:3fr 1fr;gap:30px;margin-top:24px}
@media(max-width:980px){.main-content{grid-template-columns:1fr}}

/* الأقسام (محافظة على الستايل الأصلي) */
.section{background:#fff;border:1px solid var(--line);border-radius:var(--radius);padding:25px;box-shadow:0 4px 10px rgba(0,0,0,.05);text-align:right}
.section h2{font-size:22px;font-weight:800;color:var(--primary-blue);margin-top:0;padding-bottom:10px;border-bottom:1px solid var(--line);margin-bottom:20px}
.details-table{display:grid;grid-template-columns:1fr 1fr;gap:1px;background:var(--line);border-radius:var(--radius);overflow:hidden;font-size:15px}
.detail-item{padding:12px 15px;background:#fff;display:flex;justify-content:space-between;align-items:center}
.detail-item strong{font-weight:700;color:var(--ink)}
.detail-item span{color:var(--muted);font-weight:600}
.detail-item:nth-child(even){background:#f9f9f9}

/* الاقتراحات */
.suggestions{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
.suggestion-card{background:#fff;border:1px solid var(--line);padding:12px;border-radius:10px;text-align:right;font-weight:700}
.suggestion-card a{color:var(--ink);font-weight:800}

/* FAQ */
.faq-q{display:flex;justify-content:space-between;align-items:center;font-weight:700;padding:12px 15px;border:1px solid var(--line);border-radius:8px;margin-top:10px;cursor:pointer;background:#f9f9fa;transition:background .2s;color:var(--ink)}
.faq-q span{font-size:20px;transform:rotate(0);transition:transform .3s}
.faq-item.open .faq-q span{transform:rotate(180deg)}
.faq-a{padding:15px;background:#fff;border:1px solid var(--line);border-top:none;border-radius:0 0 8px 8px;margin-top:-1px;display:none;font-size:15px;line-height:1.7;color:var(--ink)}

/* Sticky help */
.help{position:sticky;top:90px;padding:20px;border-radius:var(--radius);background:#fff;border:1px solid var(--line);box-shadow:var(--shadow);text-align:center}
.help-icon{width:80px;height:80px;object-fit:contain;margin-bottom:10px}

/* Lightbox covers (Fancybox handles most) */
#lightbox{display:none}

/* Floating WhatsApp */
.fab-wa{width:58px;height:58px;position:fixed;bottom:20px;right:20px;z-index:1100;border-radius:50%;background:var(--accent-green);box-shadow:0 4px 12px rgba(0,0,0,.2);display:flex;align-items:center;justify-content:center}
.fab-wa img{width:32px;height:32px;filter: invert(1)}
</style>
</head>
<body>

{% include header-ar.html %}

<div class="search-row" role="search" aria-label="بحث الموقع">
  <div class="search-wrap">
    <input id="siteSearch" placeholder="أبحث عن مشروعك (اسم المشروع أو المدينة)" aria-label="أبحث عن مشروعك">
    <div id="suggest" role="listbox"></div>
  </div>
</div>

<div class="container">

  <div class="breadcrumb" aria-hidden="false">
    <a href="{{ site.baseurl }}/index.html">الرئيسية</a> » <a href="{{ site.baseurl }}/sokhna.html">العين السخنة</a> » <a href="{{ site.baseurl }}/zafarana.html">الزعفرانة</a> » <a href="{{ site.baseurl }}/murano.html">مشروع مورانو</a> » <span>شاليه كود #101</span>
  </div>

  <div class="unit-title-block">
    <h1 id="unitTitle">شاليه للبيع مشروع مورانو وادي دجلة العين السخنة (3 غرف + ناني)</h1>
    <div class="small-text">كود الوحدة: <strong id="unitCode" style="color:var(--primary-blue)">#MUR-101</strong></div>
  </div>

  <!-- Slider (سيتم تعبئته من JSON) -->
  <div class="image-slider" id="imageSlider">
    <div class="swiper" id="unitSwiper">
      <div class="swiper-wrapper" id="swiperWrapper">
        <!-- Slides injected by JS from murano-units.json (fallback static images included below) -->
      </div>
      <div class="swiper-pagination"></div>
      <div class="swiper-button-next" aria-label="التالي"></div>
      <div class="swiper-button-prev" aria-label="السابق"></div>
    </div>
  </div>

  <!-- مواصفات صغيرة تحت الصور -->
  <div class="specs-section" id="specsSection">
    <div class="spec-item">
      <img src="https://j.top4top.io/p_3563c1mt61.png" alt="عدد غرف النوم">
      <p id="specRooms">3 غرف نوم + ناني</p>
    </div>
    <div class="spec-item">
      <img src="https://k.top4top.io/p_3563vaqnl2.png" alt="عدد الحمامات">
      <p id="specBaths">2 حمام</p>
    </div>
    <div class="spec-item">
      <img src="https://l.top4top.io/p_3563ijjuf3.png" alt="مساحة الوحدة">
      <p id="specArea">145 م²</p>
    </div>
  </div>
  
  <div style="text-align:center;">
    <div class="price-tag" id="priceTag">إجمالي السعر: 12,998,380 ج.م</div>
    <div class="contact-actions" style="justify-content:center; margin-top:10px;">
      <a id="phoneBtn" href="tel:+201050072527" class="btn-contact btn-phone"><i class="fas fa-phone-alt"></i> اتصال مباشر</a>
      <a id="waBtn" href="https://wa.me/201050072527" target="_blank" rel="noopener" class="btn-contact btn-whatsapp"><i class="fab fa-whatsapp"></i> واتساب (تواصل فوري)</a>
    </div>
  </div>

  <div class="main-content">
    
    <main class="right-column">
      
      <div class="section" style="padding:0">
        <h2 style="padding:25px;margin-bottom:0">تفاصيل خطة سداد الوحدة</h2>
        <div class="details-table" id="detailsTable">
          <div class="detail-item"><strong>السعر الإجمالي:</strong> <span id="dtPrice">12,998,380 ج.م</span></div>
          <div class="detail-item"><strong>المقدمة:</strong> <span id="dtDeposit">0%</span></div>
          <div class="detail-item"><strong>قسط ربع سنوي:</strong> <span id="dtInstallment">408,199 ج.م</span></div>
          <div class="detail-item"><strong>عدد الأقساط:</strong> <span id="dtCount">32 قسط</span></div>
          <div class="detail-item"><strong>مدة التقسيط:</strong> <span id="dtDuration">8 سنوات</span></div>
          <div class="detail-item"><strong>الاستلام:</strong> <span id="dtDelivery">فوري (جاهز)</span></div>
          <div class="detail-item"><strong>الصيانة:</strong> <span id="dtMaintenance">10% عند الاستلام</span></div>
          <div class="detail-item"><strong>المصدر:</strong> <span id="dtSource">من المطور</span></div>
          <div class="detail-item" style="grid-column: span 2 / auto; background:#e9ecef;"><strong>كود الوحدة:</strong> <span id="dtCode">#MUR-101</span></div>
        </div>
      </div>

      <!-- قسم الوحدات المقترحة (فوق الأسئلة الشائعة) -->
      <div class="section" id="suggestedSection">
        <h2>وحدات مقترحة</h2>
        <div class="suggestions" id="suggestion-list">
          <!-- تم تحميلها من murano-units.json - حتى 5 اقتراحات -->
        </div>
      </div>

      <div class="section">
        <h2>عن مشروع مورانو وادي دجلة</h2>
        <p>تُعد قرية مورانو العين السخنة ملاذاً هادئاً بعيدًا عن زحام وضوضاء المدينة وفي ذات الوقت تبعد مسافة ليست بالطويلة، فعلى شواطئ البحر الأحمر تُقدم مورانو تجربة فريدة تجمع بين سحر الطبيعة ورفاهية الحياة العصرية. هذا الشاليه بمساحة <strong>145 م²</strong> يوفر مساحة مثالية للعائلات، بما في ذلك <strong>3 غرف نوم رئيسية بالإضافة إلى غرفة ناني (مربية)</strong>، مما يجعله خيارًا متميزًا للخصوصية والراحة. تم تصميم Murano Wadi Degla بعناية فائقة لتوفير بيئة استثنائية تُركز على الهدوء والسكينة، مع توفير كافة وسائل الراحة والترفيه حيث تتميز بموقعها الفريد ومرافقها المتنوعة، بالإضافة إلى وجود ينابيع مياه ساخنة طبيعية تُضيف لمسة مميزة إلى القرية.</p>

        <h3>موقع قرية مورانو العين السخنة الاستراتيجي</h3>
        <p>تقع قرية مورانو في منطقة من أفضل مناطق ساحل البحر الأحمر، في نهاية طريق العين السخنة وبداية طريق الزعفرانة، هذا الموقع يجعلها أقرب منطقة ساحلية للعاصمة، كما تتميز بقربها من الطرق والمحاور الرئيسية، مما يضمن سهولة الوصول إليها من مختلف أنحاء مصر. تبعد مورانو حوالي 136 كم عن القاهرة، 18 كم من طريق الجلالة، و14 كم من محطة قطار العين السخنة.</p>
        
        <h3>أهم المرافق والخدمات الفاخرة في مورانو</h3>
        <ul>
          <li><strong>حمامات السباحة:</strong> المتنوعة بمختلف الأحجام والمساحات التي تناسب جميع أفراد العائلة.</li>
          <li><strong>شاطئ رملي خاص:</strong> يمتد بطول 750 مترًا، بالإضافة إلى مارينا بحرية بطول 100 متر للأنشطة المائية.</li>
          <li><strong>منتجع فندقي 4 نجوم:</strong> يوفر إقامة فاخرة وخدمات فندقية عالية المستوى.</li>
          <li><strong>سبا فاخر ونادي صحي:</strong> للاسترخاء والعناية بالصحة والجمال.</li>
          <li><strong>ملاعب رياضية متنوعة:</strong> لكرة القدم، التنس، والكرة الطائرة.</li>
          <li><strong>مناطق ترفيهية مخصصة للأطفال:</strong> مع ألعاب آمنة ومسلية.</li>
          <li><strong>مجموعة متنوعة من المطاعم والمقاهي:</strong> التي تقدم أشهى المأكولات والمشروبات.</li>
          <li><strong>محلات تجارية ومراكز تسوق:</strong> لتلبية جميع احتياجاتك.</li>
          <li><strong>ينابيع ماء ساخنة طبيعية:</strong> تُضيف لمسة مميزة للاسترخاء والعلاج الطبيعي.</li>
        </ul>
      </div>

      <div class="section">
        <h2>الأسئلة الشائعة عن مشروع مورانو وادي دجلة</h2>
        <div class="faq-list" id="faqList">
          <div class="faq-item">
            <div class="faq-q" tabindex="0" role="button" aria-expanded="false">ما هو موقع مشروع مورانو بالتحديد؟<span>&#9660;</span></div>
            <div class="faq-a" aria-hidden="true" style="display:none;">يقع مشروع مورانو (Murano) في منطقة الزعفرانة بالعين السخنة، على بعد 90 دقيقة من القاهرة الجديدة وعلى طريق السويس مباشرة، مما يجعله سهل الوصول من العاصمة والمدن الرئيسية.</div>
          </div>
          <div class="faq-item">
            <div class="faq-q" tabindex="0" role="button" aria-expanded="false">ما هي أنواع الوحدات المتاحة في مورانو؟<span>&#9660;</span></div>
            <div class="faq-a" aria-hidden="true" style="display:none;">يتضمن المشروع شاليهات، وشقق فندقية، بالإضافة إلى فيلات وشقق متنوعة الأحجام والتصميمات. تتوفر فيه خيارات استلام فوري أو تحت الإنشاء بأنظمة سداد ميسرة.</div>
          </div>
          <div class="faq-item">
            <div class="faq-q" tabindex="0" role="button" aria-expanded="false">ما هي أنظمة السداد المتاحة لهذه الوحدة؟<span>&#9660;</span></div>
            <div class="faq-a" aria-hidden="true" style="display:none;">هذا الشاليه تحديداً متاح بنظام سداد مميز بمقدم <strong>0%</strong> وفترة تقسيط تصل إلى <strong>8 سنوات</strong> (32 قسط ربع سنوي).</div>
          </div>
          <div class="faq-item">
            <div class="faq-q" tabindex="0" role="button" aria-expanded="false">هل هذا الشاليه جاهز للاستلام؟<span>&#9660;</span></div>
            <div class="faq-a" aria-hidden="true" style="display:none;">نعم، هذا الشاليه تحديداً كود #MUR-101 جاهز <strong>للاستلام الفوري</strong>، مما يتيح لك الاستمتاع بوحدتك الصيفية دون انتظار طويل.</div>
          </div>
          <div class="faq-item">
            <div class="faq-q" tabindex="0" role="button" aria-expanded="false">ما هي أبرز مميزات قرية مورانو العين السخنة؟<span>&#9660;</span></div>
            <div class="faq-a" aria-hidden="true" style="display:none;">تتميز مورانو بموقعها الفريد على البحر الأحمر، شاطئ رملي خاص، حمامات سباحة متنوعة، منتجع فندقي فاخر، مناطق ترفيهية للأطفال، بالإضافة إلى ينابيع مياه ساخنة طبيعية.</div>
          </div>
        </div>
      </div>
      
    </main>

    <aside class="help" id="helpBox" aria-labelledby="helpTitle">
      <img src="https://c.top4top.io/p_3563kzyu40.png" alt="icon" class="help-icon" onerror="this.onerror=null;this.src='https://picsum.photos/seed/helpicon/120/120'">
      <h3 id="helpTitle">تحتاج إلى استشارة عقارية؟</h3>
      <p>املأ بياناتك وسنعاود الاتصال بك قريبًا لمعرفة أفضل العروض.</p>

      <div style="text-align:right">
        <label for="hName">الاسم الكامل</label>
        <input id="hName" placeholder="الاسم الكامل" required>

        <label for="hPhone">الهاتف المحمول</label>
        <input id="hPhone" placeholder="+20 10xxxxxxxx" required>

        <label for="hProject">الوحدة المحددة</label>
        <input id="hProject" value="شاليه مورانو كود #MUR-101 (145 م²)" readonly>

        <label for="hBudget">السعر الأساسي</label>
        <input id="hBudget" value="12,998,380 ج.م" readonly>

        <label for="hNote">ملاحظة / تفاصيل إضافية</label>
        <textarea id="hNote" placeholder="اذكر موعد معاينة أو سؤال محدد..."></textarea>

        <button id="hWA" title="إرسال عبر واتساب للمتابعة السريعة">إرسال استفساري عبر واتساب</button>
        <button id="hMail" title="إرسال التفاصيل عبر البريد الإلكتروني">إرسال عبر إيميل</button>
      </div>
    </aside>

  </div>
</div>

<!-- Fancybox default container (Fancybox UI) -->
<div id="lightbox" role="dialog" aria-modal="true" aria-hidden="true" style="display:none;"></div>

<!-- Floating WhatsApp -->
<a class="fab-wa" id="fabWa" href="https://wa.me/201050072527" target="_blank" rel="noopener" aria-label="WhatsApp للتواصل السريع">
  <img src="https://i.top4top.io/p_3537mv0672.png" alt="WhatsApp icon">
</a>

{% include footer-ar.html %}

<!-- Scripts: Swiper + Fancybox -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script>

<script>
/* ---------------- 1. Search Script (كما في النسخة الأصلية) ---------------- */
(function(){
  const INPUT = document.getElementById('siteSearch');
  const BOX    = document.getElementById('suggest');
  if(!INPUT || !BOX) return;

  function ensureAbsolutePath(path){
    if(!path) return '{{ site.baseurl }}/';
    if(path.startsWith('http') || path.startsWith('#')) return path;
    let cleanedPath = path.startsWith('/') ? path : '/' + path;
    return '{{ site.baseurl }}' + cleanedPath;
  }

  let SITE_INDEX = [];
  fetch('{{ site.baseurl }}/search-index.json', {cache:'no-store'})
    .then(r => r.json())
    .then(json => SITE_INDEX = Array.isArray(json) ? json : [])
    .catch(() => SITE_INDEX = []);

  const makeItem = it => {
    const a = document.createElement('a');
    a.href = ensureAbsolutePath(it.url || it.permalink);
    a.textContent = it.title || it.name || it.permalink || 'بدون عنوان';
    return a;
  };

  function search(q){
    q = (q || '').trim().toLowerCase();
    if(!q) return [];
    return SITE_INDEX
      .map(it=>{
        const hay = ((it.title||'') + ' ' + (it.keywords||'') + ' ' + (it.categories||'')).toLowerCase();
        const inTitle = (it.title||'').toLowerCase().includes(q) ? 2 : 0;
        const inKeys  = hay.includes(q) ? 1 : 0;
        return {...it, score: inTitle + inKeys};
      })
      .filter(x => x.score > 0)
      .sort((a,b) => b.score - a.score)
      .slice(0,8);
  }

  function render(list){
    BOX.innerHTML = '';
    if(list.length === 0){ BOX.style.display='none'; return; }
    list.forEach(r => BOX.appendChild(makeItem(r)));
    BOX.style.display = 'block';
  }

  INPUT.addEventListener('input', ()=> render(search(INPUT.value)));
  document.addEventListener('click', (e)=>{
    if(!BOX.contains(e.target) && e.target !== INPUT) BOX.style.display='none';
  });
  INPUT.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){
      const first = BOX.querySelector('a');
      if(first){ window.location.href = first.href; }
    }
  });
})();

/* ---------------- 2. Load unit data & images from murano-units.json ----------------
   - يقرأ البيانات من /murano-units.json
   - يملأ الصور للسلايدر (يدعم السحب عبر Swiper) ويفتح لايت بوكس عبر Fancybox
   - يملأ المواصفات، السعر، جدول التفاصيل، وصندوق المساعدة (hProject/hBudget)
   - يقترح حتى 5 وحدات مشابهة (من نفس JSON) ويعرض عنوان الوحدة فقط
*/
(async function(){
  const CURRENT_CODE_EL = document.getElementById('unitCode');
  const currentCodeRaw = (CURRENT_CODE_EL?.textContent || '#MUR-101').trim();
  const CURRENT_CODE = currentCodeRaw.replace('#','').trim().toUpperCase();

  // Fallback images (in case JSON fails)
  const FALLBACK_IMAGES = [
    "https://g.top4top.io/p_3563nwxqm0.jpg",
    "https://h.top4top.io/p_3563r5o301.jpg",
    "https://j.top4top.io/p_3563myq0h3.jpg",
    "https://g.top4top.io/p_3563ttwox0.jpg"
  ];

  // Helper: format currency (basic)
  function formatCurrency(val){
    if(val == null) return '';
    try{
      // if number -> format with commas
      if(typeof val === 'number') return val.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' ج.م';
      // if string and contains digits only
      const onlyDigits = String(val).replace(/[^\d]/g,'');
      if(onlyDigits.length > 0) return Number(onlyDigits).toLocaleString('en-US') + ' ج.م';
      return String(val);
    }catch(e){ return String(val); }
  }

  // Safe fetch JSON
  let unitsData = [];
  try{
    const res = await fetch('/murano-units.json', {cache:'no-store'});
    if(!res.ok) throw new Error('not found');
    const json = await res.json();
    // Accept raw array or { units: [...] } or {data: [...]}
    if(Array.isArray(json)) unitsData = json;
    else if(Array.isArray(json.units)) unitsData = json.units;
    else if(Array.isArray(json.data)) unitsData = json.data;
    else {
      // try to collect values that look like units
      const possible = Object.values(json).filter(v=>Array.isArray(v)).flat();
      unitsData = possible.length ? possible : [];
    }
  }catch(err){
    console.warn('murano-units.json not loaded or invalid, using fallbacks', err);
    unitsData = [];
  }

  // find current unit robustly
  function findUnit(list, code){
    code = (code || '').toString().toLowerCase();
    if(!code) return null;
    // try exact matches on several keys
    return list.find(u => {
      if(!u) return false;
      const keys = ['code','id','unitCode','unit_id','slug','permalink'];
      for(const k of keys){
        if(u[k] && String(u[k]).toLowerCase().replace(/^#/,'') === code) return true;
      }
      // title contains code?
      if(u.title && String(u.title).toLowerCase().includes(code)) return true;
      // url contains code
      if(u.url && String(u.url).toLowerCase().includes(code)) return true;
      return false;
    }) || null;
  }

  const unit = findUnit(unitsData, CURRENT_CODE);

  // Elements to update
  const swiperWrapper = document.getElementById('swiperWrapper');
  const specRooms = document.getElementById('specRooms');
  const specBaths = document.getElementById('specBaths');
  const specArea = document.getElementById('specArea');
  const priceTag = document.getElementById('priceTag');
  const dtPrice = document.getElementById('dtPrice');
  const dtDeposit = document.getElementById('dtDeposit');
  const dtInstallment = document.getElementById('dtInstallment');
  const dtCount = document.getElementById('dtCount');
  const dtDuration = document.getElementById('dtDuration');
  const dtDelivery = document.getElementById('dtDelivery');
  const dtMaintenance = document.getElementById('dtMaintenance');
  const dtSource = document.getElementById('dtSource');
  const dtCode = document.getElementById('dtCode');
  const hProject = document.getElementById('hProject');
  const hBudget = document.getElementById('hBudget');
  const unitTitle = document.getElementById('unitTitle');

  // helper: safely get field with fallback keys
  function pickField(u, keys, fallback){
    for(const k of keys){
      if(u && (u[k] !== undefined && u[k] !== null)) return u[k];
    }
    return fallback;
  }

  // Build slides from images array
  function buildSlides(images, unitTitleText){
    swiperWrapper.innerHTML = ''; // clear
    const imgs = (Array.isArray(images) && images.length) ? images : FALLBACK_IMAGES;
    imgs.forEach((imgUrl, idx) => {
      const slide = document.createElement('div');
      slide.className = 'swiper-slide';
      // anchor with data-fancybox
      const a = document.createElement('a');
      a.setAttribute('data-fancybox','gallery');
      a.setAttribute('href', imgUrl);
      a.setAttribute('data-caption', unitTitleText || '');
      const imgel = document.createElement('img');
      imgel.setAttribute('src', imgUrl);
      imgel.setAttribute('alt', unitTitleText || ('صورة ' + (idx+1)));
      imgel.style.width = '100%';
      imgel.style.height = '400px';
      imgel.style.objectFit = 'cover';
      imgel.style.borderRadius = 'var(--radius)';
      a.appendChild(imgel);
      slide.appendChild(a);
      swiperWrapper.appendChild(slide);
    });
  }

  // Init Swiper and Fancybox after slides exist
  let unitSwiper = null;
  function initSliderAndFancybox(){
    // destroy previous swiper if exists
    try{ if(unitSwiper && unitSwiper.destroy) unitSwiper.destroy(true, true); }catch(e){}
    unitSwiper = new Swiper('#unitSwiper', {
      loop: true,
      pagination: { el: '.swiper-pagination', clickable: true },
      navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
      grabCursor: true,
      spaceBetween: 10,
      slidesPerView: 1,
      lazy: { loadPrevNext: true },
    });
    // bind Fancybox (v4)
    try{
      // unbind previous to avoid duplicates
      if(window.Fancybox) {
        // bind anchors with data-fancybox="gallery"
        Fancybox.bind("[data-fancybox='gallery']", {
          Thumbs: false,
          Toolbar: {
            display: [
              { id: "counter", position: "center" },
              "close"
            ]
          },
          Images: {
            // allow zoom on desktop
            wheel: "slide"
          }
        });
      }
    }catch(e){ console.warn('Fancybox bind error', e) }
  }

  // Suggestions logic: choose up to 5 similar units
  function renderSuggestions(allUnits, currentUnit){
    const container = document.getElementById('suggestion-list');
    container.innerHTML = '';
    if(!Array.isArray(allUnits) || allUnits.length === 0) return;
    // Exclude current
    const others = allUnits.filter(u => {
      const code = (u.code||u.id||u.unitCode||'').toString().toLowerCase().replace(/^#/,'');
      return code !== (CURRENT_CODE || '').toString().toLowerCase();
    });
    if(others.length === 0) return;
    // similarity: same bedrooms first, then sort by area diff
    const curBeds = Number(pickField(currentUnit, ['bedrooms','beds','rooms'], NaN));
    const curArea = Number(pickField(currentUnit, ['area','size','sqm'], NaN));
    let sameBeds = others.filter(u => Number(pickField(u, ['bedrooms','beds','rooms'], NaN)) === curBeds);
    let rest = others.filter(u => !sameBeds.includes(u));
    // sort each by area proximity if area exists
    function sortByArea(arr){
      return arr.sort((a,b)=>{
        const da = Math.abs((Number(pickField(a,['area','size','sqm'],NaN)) || 0) - (curArea || 0));
        const db = Math.abs((Number(pickField(b,['area','size','sqm'],NaN)) || 0) - (curArea || 0));
        return da - db;
      });
    }
    sameBeds = sortByArea(sameBeds);
    rest = sortByArea(rest);
    const final = sameBeds.concat(rest).slice(0,5); // max 5
    final.forEach(u=>{
      const card = document.createElement('div');
      card.className = 'suggestion-card';
      // determine url and title
      const url = u.url || u.permalink || (u.slug ? ('/'+u.slug) : ('/murano-units' + (u.code ? u.code : '')) );
      const title = u.title || u.name || (u.code ? (u.code + ' - وحدة') : 'وحدة مقترحة');
      card.innerHTML = `<a href="${url}">${title}</a>`;
      container.appendChild(card);
    });
  }

  // Populate fallback content first (so page not empty while fetching)
  buildSlides(FALLBACK_IMAGES, document.getElementById('unitTitle').textContent);
  initSliderAndFancybox();

  // If unit found => populate dynamic fields
  if(unit){
    // Title
    const titleText = pickField(unit, ['title','name','unit_title'], document.getElementById('unitTitle').textContent);
    if(titleText) unitTitle.textContent = titleText;

    // Specs
    const bedrooms = pickField(unit, ['bedrooms','beds','rooms'], '3');
    const baths = pickField(unit, ['bathrooms','baths'], '2');
    const area = pickField(unit, ['area','size','sqm'], '145 م²');

    specRooms.textContent = (bedrooms ? bedrooms + ' غرف' : '3 غرف') + (unit.nanny ? ' + ناني' : ' + ناني');
    specBaths.textContent = (baths ? baths + ' حمام' : '2 حمام');
    specArea.textContent = (typeof area === 'number' ? (area + ' م²') : (String(area).toString()));

    // Price and details
    const priceRaw = pickField(unit, ['price','amount','sale_price'], null);
    const deposit = pickField(unit, ['deposit','down_payment'], '0%');
    const installment = pickField(unit, ['installment_quarterly','quarter_installment','installment'], '');
    const installmentsCount = pickField(unit, ['installments_count','installments','num_installments'], '');
    const duration = pickField(unit, ['payment_duration','duration','term'], '');
    const delivery = pickField(unit, ['delivery','status','availability'], 'فوري (جاهز)');
    const maintenance = pickField(unit, ['maintenance','service_charge'], '10% عند الاستلام');
    const source = pickField(unit, ['source','from'], 'من المطور');
    const codeVal = pickField(unit, ['code','id','unitCode'], CURRENT_CODE);

    priceTag.textContent = 'إجمالي السعر: ' + (priceRaw ? formatCurrency(priceRaw) : '—');
    dtPrice.textContent = priceRaw ? formatCurrency(priceRaw) : '—';
    dtDeposit.textContent = deposit || '—';
    dtInstallment.textContent = installment || '—';
    dtCount.textContent = installmentsCount ? String(installmentsCount) : '—';
    dtDuration.textContent = duration || '—';
    dtDelivery.textContent = delivery || '—';
    dtMaintenance.textContent = maintenance || '—';
    dtSource.textContent = source || '—';
    dtCode.textContent = (codeVal ? ('#' + codeVal) : ('#' + CURRENT_CODE));

    // help form values
    if(hProject) hProject.value = (titleText || 'شاليه مورانو') + ' كود #' + (codeVal || CURRENT_CODE) + ' (' + (area || '') + ')';
    if(hBudget) hBudget.value = priceRaw ? formatCurrency(priceRaw) : (hBudget.value || '');

    // slide images: try several keys
    let imagesArr = pickField(unit, ['images','photos','gallery','imgs'], []);
    if(typeof imagesArr === 'string') imagesArr = [imagesArr];
    imagesArr = Array.isArray(imagesArr) ? imagesArr.filter(Boolean) : [];
    // if images empty, try to build from image fields
    if(imagesArr.length === 0){
      const possible = [];
      ['image','photo','img1','img2','img3','main_image'].forEach(k=>{
        if(unit[k]) possible.push(unit[k]);
      });
      imagesArr = possible.filter(Boolean);
    }
    // if still empty, keep fallback
    buildSlides(imagesArr.length ? imagesArr : FALLBACK_IMAGES, titleText);
    initSliderAndFancybox();

    // update phone/whatsapp links if provided
    const phone = pickField(unit, ['phone','contact_phone','tel'], '+201050072527');
    const wa = pickField(unit, ['whatsapp','wa','contact_wa','wa_number'], '201050072527');
    const phoneBtn = document.getElementById('phoneBtn');
    const waBtn = document.getElementById('waBtn');
    const fab = document.getElementById('fabWa');
    if(phoneBtn) phoneBtn.href = 'tel:' + phone;
    if(waBtn) waBtn.href = (wa.toString().startsWith('http') ? wa : ('https://wa.me/' + wa.toString().replace(/\D/g,'')));
    if(fab) fab.href = (wa.toString().startsWith('http') ? wa : ('https://wa.me/' + wa.toString().replace(/\D/g,'')));

    // suggestions: render up to 5 similar units based on bedrooms/area
    renderSuggestions(unitsData, unit);
  } else {
    // unit not found: render suggestions by taking first up to 5 from JSON (if available)
    if(unitsData.length){
      // show first 5 excluding current code if any
      const choices = unitsData.filter(u=> {
        const code = (u.code||u.id||'').toString().toLowerCase().replace(/^#/,'');
        return code !== (CURRENT_CODE||'').toString().toLowerCase();
      }).slice(0,5);
      const container = document.getElementById('suggestion-list');
      choices.forEach(u=>{
        const card = document.createElement('div');
        card.className = 'suggestion-card';
        const url = u.url || u.permalink || ('/murano-units' + (u.code || ''));
        const title = u.title || u.name || (u.code ? (u.code + ' - وحدة') : 'وحدة مقترحة');
        card.innerHTML = `<a href="${url}">${title}</a>`;
        container.appendChild(card);
      });
    }
  }
})();

/* ---------------- 3. FAQ Toggle ---------------- */
document.querySelectorAll('.faq-q').forEach(q => {
  q.addEventListener('click', function() {
    const parent = this.closest('.faq-item');
    const answer = parent.querySelector('.faq-a');
    const isOpen = parent.classList.toggle('open');
    this.setAttribute('aria-expanded', isOpen);
    answer.setAttribute('aria-hidden', !isOpen);
    answer.style.display = isOpen ? 'block' : 'none';
  });
});

/* ---------------- 4. Help Form Actions (واتساب + إيميل) ---------------- */
function getVal(id){ return (document.getElementById(id)?.value||'').trim(); }
document.getElementById('hWA').addEventListener('click', ()=> {
  const txt = `مرحباً، أرجو تزويدي بتفاصيل الوحدة - ${getVal('hProject')} - الاسم: ${getVal('hName')} - الهاتف: ${getVal('hPhone')} - ملاحظة: ${getVal('hNote')}`;
  // use the floating WhatsApp number if available
  const waLink = document.getElementById('fabWa')?.href || 'https://wa.me/201050072527';
  // open compose
  window.open(waLink + '?text=' + encodeURIComponent(txt).replace('https://wa.me/https://','https://'), '_blank');
});
document.getElementById('hMail').addEventListener('click', ()=> {
  const subj = `استفسار عن وحدة - ${getVal('hProject')} - ${getVal('hName')}`;
  const body = `الاسم: ${getVal('hName')}\nالهاتف: ${getVal('hPhone')}\nالوحدة: ${getVal('hProject')}\nالميزانية: ${getVal('hBudget')}\nملاحظات:\n${getVal('hNote')}`;
  location.href = `mailto:islammesmail@gmail.com?subject=${encodeURIComponent(subj)}&body=${encodeURIComponent(body)}`;
});
</script>
</body>
</html>
